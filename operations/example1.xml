<?xml version="1.0" encoding="UTF-8"?>
<dm:document
  xmlns:dm="urn:broadband-forum-org:cwmp:datamodel-1-6"
  xmlns:dmr="urn:broadband-forum-org:cwmp:datamodel-report-0-1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="urn:broadband-forum-org:cwmp:datamodel-1-6
                        cwmp-datamodel-1-6.xsd
                      urn:broadband-forum-org:cwmp:datamodel-report-0-1
                        http://www.broadband-forum.org/cwmp/cwmp-datamodel-report.xsd"
  spec="urn:broadband-forum-org:example1"
  file="example1.xml">

  <description>
    DM instance that illustrates USP commands.
  </description>

  <import file="tr-069-biblio.xml"/>

  <bibliography>
    <reference id="REF">
      <name>Placeholder</name>
    </reference>
  </bibliography>

  <component name="CommandContext">
    <parameter name="Target" access="readOnly">
      <description>
        {{reference|the object on which this command was invoked|delete}}
      </description>
      <syntax>
        <string>
          <pathRef targetType="object" refType="strong"/>
        </string>
      </syntax>
    </parameter>
  </component>
  
  <!-- This pattern can be used for defining any type of command -->

  <component name="RebootCommandInputs">
  </component>
  
  <component name="RebootCommandOutputs">
  </component>
  
  <component name="RebootCommand">
    <command name="Reboot()" async="true" notify="Boot">
      <description>
        Reboot the entity represented by the object on which this command is invoked.
      </description>
      <input>
        <component ref="RebootCommandInputs"/>
      </input>
      <output>
        <component ref="RebootCommandOutputs"/>
      </output>
    </command>
  </component>

  <component name="RebootCommandInstance">
    <component ref="CommandContext"/>
    <component ref="RebootCommandInputs"/>
    <component ref="RebootCommandOutputs"/>
  </component>

  <component name="DownloadCommandInputArguments">
    <parameter name="URL" mandatory="true">
      <description>
        URL, as defined in {{bibref|REF}}, specifying the source file location...
      </description>
      <syntax>
        <string>
          <size maxLength="256"/>
        </string>
      </syntax>
    </parameter>
    <parameter name="FileType">
      <description>
        An integer followed by a space followed by the file type description. Only the following values are currently defined for the {{param}} argument:
        {{enum}}
        The following format is defined to allow the unique definition of vendor-specific file types:
        * "X &lt;VENDOR&gt; &lt;Vendor-specific identifier&gt;"
        ...
      </description>
      <syntax>
        <string>
          <size maxLength="64"/>
          <enumeration value="1 Firmware Upgrade Image"/>
          <enumeration value="2 Web Content"/>
          <enumeration value="3 Vendor Configuration File"/>
          <enumeration value="4 Tone File"/>
          <enumeration value="5 Ringer File"/>
        </string>
        <default type="parameter" value="1 Firmware Upgrade Image"/>
      </syntax>
    </parameter>
    <parameter name="Username">
      <description>
        Username to be used by the CPE to authenticate with the file server. This string is set to {{empty}} if no authentication is required.
      </description>
      <syntax>
        <string>
          <size maxLength="256"/>
        </string>
        <default type="parameter" value=""/>
      </syntax>
    </parameter>
    <parameter name="Password">
      <description>
        Password to be used by the CPE to authenticate with the file server. This string is set to {{empty}} if no authentication is required.
      </description>
      <syntax>
        <string>
          <size maxLength="256"/>
        </string>
        <default type="parameter" value=""/>
      </syntax>
    </parameter>
    <parameter name="FileSize">
      <description>
        The size of the file to be downloaded in bytes.
        The {{param}} argument is intended as a hint to the CPE, which the CPE MAY use to determine if it has sufficient space for the file to be downloaded, or to prepare space to accept the file.
        ...
      </description>
      <syntax>
        <unsignedInt/>
        <default type="parameter" value="0"/>
      </syntax>
    </parameter>
    <parameter name="TargetFileName">
      <description>
        The name of the file to be used on the target file system...
      </description>
      <syntax>
        <string>
          <size maxLength="256"/>
        </string>
        <default type="parameter" value=""/>
      </syntax>
    </parameter>
    <parameter name="DelaySeconds">
      <description>
        This argument has different meanings for Unicast and Multicast downloads...
      </description>
      <syntax>
        <unsignedInt/>
        <default type="parameter" value="0"/>
      </syntax>
    </parameter>
    <parameter name="SuccessURL">
      <description>
        When applicable, this argument contains the URL, as defined in {{bibref|REF}}, the CPE SHOULD redirect the user’s browser to if the download completes successfully...
      </description>
      <syntax>
        <string>
          <size maxLength="256"/>
        </string>
        <default type="parameter" value=""/>
      </syntax>
    </parameter>
    <parameter name="FailureURL">
      <description>
        When applicable, this argument contains the URL, as defined in {{bibref|REF}}, the CPE SHOULD redirect the user’s browser to if the download does not complete successfully...
      </description>
      <syntax>
        <string>
          <size maxLength="256"/>
        </string>
        <default type="parameter" value=""/>
      </syntax>
    </parameter>      
  </component>

  <component name="DownloadCommandOutputArguments">
    <parameter name="Status">
      <description>
        A successful response to this method returns an integer enumeration defined as follows...
      </description>
      <syntax>
        <int>
          <range minInclusive="0" maxInclusive="1"/>
        </int>
        <default type="parameter" value="1"/>
      </syntax>
    </parameter>
    <parameter name="StartTime">
      <description>
        The date and time download was started in UTC...
      </description>
      <syntax>
        <dateTime/>
        <default type="parameter" value="0001-01-01T00:00:00Z"/>
      </syntax>
    </parameter>
    <parameter name="CompleteTime">
      <description>
        The date and time the download was fully completed and applied in UTC...
      </description>
      <syntax>
        <dateTime/>
        <default type="parameter" value="0001-01-01T00:00:00Z"/>
      </syntax>
    </parameter>    
  </component>

  <component name="TransferCompleteArguments">
    <parameter name="AnnounceURL">
      <description>
        The URL on which the CPE listened to the announcements that led to this transfer being performed, or an empty string if this transfer was not performed as a result of an announcement, or {{empty}} if no such URL is available.
      </description>
      <syntax>
        <string>
          <size maxLength="1024"/>
        </string>
        <default type="parameter" value=""/>
      </syntax>
    </parameter>
    <parameter name="TransferURL">
      <description>
        The URL from or to which this transfer was performed, or {{empty}} if no such URL is available.
      </description>
      <syntax>
        <string>
          <size maxLength="1024"/>
        </string>
        <default type="parameter" value=""/>
      </syntax>
    </parameter>
    <parameter name="IsDownload">
      <description>
        Indicates whether the autonomous transfer was a download ({{true}}) or an upload ({{false}}).
      </description>
      <syntax>
        <boolean/>
        <default type="parameter" value="true"/>
      </syntax>
    </parameter>
    <parameter name="FileType">
      <description>
        An integer followed by a space followed by the file type description. Only the following values are currently defined for the {{param}} argument:
        {{enum}}
        The following format is defined to allow the unique definition of vendor-specific file types:
        * "X &lt;VENDOR&gt; &lt;Vendor-specific identifier&gt;"
        ...
      </description>
      <syntax>
        <string>
          <size maxLength="64"/>
          <enumeration value="1 Firmware Upgrade Image"/>
          <enumeration value="2 Web Content"/>
          <enumeration value="3 Vendor Configuration File"/>
          <enumeration value="4 Tone File"/>
          <enumeration value="5 Ringer File"/>
        </string>
        <default type="parameter" value="1 Firmware Upgrade Image"/>
      </syntax>
    </parameter>
    <parameter name="FileSize">
      <description>
        The size of the file in bytes, or zero if this information is not available or if the CPE chooses not to make it available.
      </description>
      <syntax>
        <unsignedInt/>
        <default type="parameter" value="0"/>
      </syntax>
    </parameter>
    <parameter name="TargetFileName">
      <description>
        The name of the file on the target (CPE) file system...
      </description>
      <syntax>
        <string>
          <size maxLength="256"/>
        </string>
        <default type="parameter" value=""/>
      </syntax>
    </parameter>
    <parameter name="FaultCode">
      <description>
        The numerical fault code as defined in {{bibref|TR-069a5|Section A.5.1}}...
      </description>
      <syntax>
        <unsignedInt/>
        <default type="parameter" value="0"/>
      </syntax>
    </parameter>
    <parameter name="FaultString">
      <description>
        A human-readable text description of the fault. This field SHOULD be {{empty}} if the {{param|FaultCode}} equals 0 (zero).
      </description>
      <syntax>
        <string>
          <size maxLength="256"/>
        </string>
        <default type="parameter" value=""/>
      </syntax>
    </parameter>
    <parameter name="StartTime">
      <description>
        The date and time transfer was started in UTC...
      </description>
      <syntax>
        <dateTime/>
        <default type="parameter" value="0001-01-01T00:00:00Z"/>
      </syntax>
    </parameter>
    <parameter name="CompleteTime">
      <description>
        The date and time the transfer was fully completed and applied in UTC...
      </description>
      <syntax>
        <dateTime/>
        <default type="parameter" value="0001-01-01T00:00:00Z"/>
      </syntax>
    </parameter>    
    
  </component>

  <component name="DownloadCommandInputs">
    <object name="Input.">
      <component ref="DownloadCommandInputArguments"/>
    </object>
  </component>
  
  <component name="DownloadCommandOutputs">
    <object name="Output.">
      <component ref="DownloadCommandOutputArguments"/>
    </object>
  </component>

  <component name="DownloadCommand">
    <command name="Download()" async="true" notify="TransferComplete">
      <description>
        Download a file to the entity represented by the object on which this command is invoked.
        {{issue|Argument names are shown with leading "#" characters as a reminder that they don't exist in the data model.}}
      </description>
      <input>
        <component ref="DownloadCommandInputArguments"/>
      </input>
      <output>
        <component ref="DownloadCommandOutputArguments"/>
      </output>
    </command>
  </component>
  
  <component name="DownloadCommandInstance">
    <component ref="CommandContext"/>
    <component ref="DownloadCommandInputs"/>
    <component ref="DownloadCommandOutputs"/>
  </component>
  
  <component name="TransferCompleteNotification">
    <notification name="TransferComplete">
      <description>
        Inform the ACS of the completion (either successful or unsuccessful) of a file transfer that was not specifically requested by the ACS...
        {{issue|Argument names are shown with leading "#" characters as a reminder that they don't exist in the data model.}}
      </description>
      <component ref="TransferCompleteArguments"/>
    </notification>
  </component>
  
  <model name="Command:1.0">
    <object name="Device." access="readOnly" minEntries="1" maxEntries="1">
      <description>
        Physical device. The Reboot and Download commands operate on the device.
      </description>
      <parameter name="ExecEnvNumberOfEntries" access="readOnly">
        <description>{{numentries}}</description>
        <syntax><unsignedInt/></syntax>
      </parameter>
      <parameter name="LightNumberOfEntries" access="readOnly">
        <description>{{numentries}}</description>
        <syntax><unsignedInt/></syntax>
      </parameter>
      <parameter name="DimmerNumberOfEntries" access="readOnly">
        <description>{{numentries}}</description>
        <syntax><unsignedInt/></syntax>
      </parameter>
    </object>

    <!-- XXX could reference the components from within Device. but this mucks up the ordering in the report -->
    <component path="Device." ref="RebootCommand"/>
    <component path="Device." ref="DownloadCommand"/>
    <component path="Device." ref="TransferCompleteNotification"/>

    <object name="Device.ExecEnv.{i}." access="readOnly" minEntries="0" maxEntries="unbounded"
      numEntriesParameter="ExecEnvNumberOfEntries" dmr:noUniqueKeys="true">
      <description>
        Execution environments. The Reboot command operates on the execution environment instance.
      </description>
    </object>

    <component path="Device.ExecEnv.{i}." ref="RebootCommand"/>

    <object name="Device.Light.{i}." access="readOnly" minEntries="0" maxEntries="unbounded"
      numEntriesParameter="LightNumberOfEntries">
      <uniqueKey functional="false">
        <parameter ref="Name"/>
      </uniqueKey>
      <parameter name="Name" access="readOnly">
        <description>
          Name of the light.
        </description>
        <syntax><string/></syntax>
      </parameter>
      <command name="On()">
        <description>
          Switch the light on.
        </description>
      </command>
      <command name="Off()">
        <description>
          Switch the light off.
        </description>
      </command>
      <command name="Toggle()">
        <description>
          Toggle the state of the light.
        </description>
        <output>
          <parameter name="WasOn">
            <description>
              Whether the light was on.
            </description>
            <syntax><boolean/></syntax>
          </parameter>          
        </output>
      </command>
    </object>
    
    <object name="Device.Dimmer.{i}." access="readOnly" minEntries="0" maxEntries="unbounded"
      numEntriesParameter="DimmerNumberOfEntries">
      <uniqueKey functional="false">
        <parameter ref="Name"/>
      </uniqueKey>
      <parameter name="Name" access="readOnly">
        <description>
          Name of the dimmer.
        </description>
        <syntax><string/></syntax>
      </parameter>
      <command name="SetBrightness()">
        <description>
          Set the dimmer's brightness.
        </description>
        <input>
          <parameter name="Brightness">
            <description>
              Requested brightness in {{units}}.
            </description>
            <syntax>
              <unsignedInt>
                <range minInclusive="0" maxInclusive="100"/>
                <units value="percent"/>
              </unsignedInt>
              <default type="parameter" value="100"/>
            </syntax>
          </parameter>
        </input>
        <output>
          <parameter name="PreviousBrightness">
            <description>
              Previous brightness in {{units}}.
            </description>
            <syntax>
              <unsignedInt>
                <range minInclusive="0" maxInclusive="100"/>
                <units value="percent"/>
              </unsignedInt>
            </syntax>
          </parameter>
        </output>
      </command>
      <command name="On()">
        <description>
          Switch the dimmer off. The same as ''SetBrightness(100)''.
        </description>
      </command>
      <command name="Off()">
        <description>
          Switch the dimmer off. The same as ''SetBrightness(0)''.
        </description>
      </command>
    </object>
    
    <object name="Device.Operations." access="readOnly" minEntries="1" maxEntries="1">
      <description>
        Data model operations. This object is automatically maintained by the USP Agent.
        * The {{object|Commands}} object contains a table for each supported command, e.g. {{object|Commands.Reboot}}. These tables contain an entry for each active command.
        * The {{object|Request}} table contains an entry for each active request. Each ''Request'' references the corresponding command instance.
      </description>
      <parameter name="RequestNumberOfEntries" access="readOnly">
        <description>{{numentries}}</description>
        <syntax><unsignedInt/></syntax>
      </parameter>
    </object>
    
    <object name="Device.Operations.Commands." access="readOnly" minEntries="1" maxEntries="1">
      <description>
        Active commands.
      </description>
      <parameter name="RebootNumberOfEntries" access="readOnly">
        <description>{{numentries}}</description>
        <syntax><unsignedInt/></syntax>
      </parameter>
      <parameter name="DownloadNumberOfEntries" access="readOnly">
        <description>{{numentries}}</description>
        <syntax><unsignedInt/></syntax>
      </parameter>
    </object>
    
    <object name="Device.Operations.Commands.Reboot.{i}." access="readOnly" minEntries="0" maxEntries="unbounded"
      numEntriesParameter="RebootNumberOfEntries" dmr:noUniqueKeys="true">
      <description>
        Active Reboot commands.
      </description>
      <component ref="RebootCommandInstance"/>      
    </object>
    
    <object name="Device.Operations.Commands.Download.{i}." access="readOnly" minEntries="0" maxEntries="unbounded"
      numEntriesParameter="DownloadNumberOfEntries" dmr:noUniqueKeys="true">
      <description>
        Active Download commands.
      </description>
      <component ref="DownloadCommandInstance"/>      
    </object>
    
    <object name="Device.Operations.Request.{i}." access="readOnly" minEntries="0" maxEntries="unbounded"
      numEntriesParameter="RequestNumberOfEntries">
      <description>
        Device operations. {{object}} instances are created using USP ''Operate'' messages. Only ''Operate'' messages with ''async''=''true'' will create a {{object}} instance in the data model.
        An ''Operate'' message is associated with a command; commands are declared using the DM ''command'' element (a legacy CWMPv1 command parameter is a parameterless USP command).
        {{issue|{{param|CommandKey}} would be a unique key, but can't be because it might be empty. We could add a DM uniqueKey attribute to cover this case, or could require the device to assign a unique value when the Controller doesn't supply one. The latter is better?}}
      </description>
      <uniqueKey functional="true">
        <parameter ref="Command"/>
      </uniqueKey>
      <parameter name="Command" access="readOnly">
        <description>
          {{reference||delete}}
          {{issue|It's not possible to list all the possible targets in this way. They should be listed by base type (''Command'') rather than by name.}}
        </description>
        <syntax>
          <string>
            <pathRef targetType="row" targetParent="#.Commands.Reboot. #.Commands.Download." refType="strong"/>
          </string>
        </syntax>
      </parameter>
      <parameter name="CommandKey" access="readOnly">
        <description>
          The command key from the USP ''Operate'' message.
        </description>
        <syntax><string/></syntax>
      </parameter>
      <parameter name="State" access="readOnly">
        <syntax>
          <string>
            <enumeration value="Requested"/>
            <enumeration value="Active"/>
            <enumeration value="Canceling"/>
            <enumeration value="Canceled"/>
            <enumeration value="Success"/>
            <enumeration value="Error"/>
          </string>
        </syntax>
      </parameter>
      <parameter name="Message" access="readOnly">
        <description>
          Generic error message.
        </description>
        <syntax><string/></syntax>
      </parameter>
      <parameter name="Detail" access="readOnly">
        <description>
          Detailed error message.
        </description>
        <syntax><string/></syntax>
      </parameter>
      <command name="Cancel()">
        <description>
          Request cancelation of this {{object}}'s command.
          This command completes immediately. If successul, {{param|State}} will immediately change to {{enum|Canceling|State}} and will change to {{enum|Canceled|State}} when the cancelation is complete.
        </description>
      </command>
    </object>

  </model>
</dm:document>